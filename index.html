<!DOCTYPE html>
<html>
<head>
  <title>Sentinel - facial recognition system</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:title" content="Sentinel - facial recognition system" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://beatobongco.com/sentinel/" />
  <meta property="og:image" content="https://beatobongco.com/UI-Kata/index-assets/og.png" />
  <meta property="og:description" content="Proof of concept quick facial recognition system." />
  <meta name="description" content="Proof of concept quick facial recognition system.">
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/flexboxgrid/6.3.1/flexboxgrid.min.css">
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>
  <div class="title">
    <h1>Sentinel</h1>
    <p>Proof of concept quick facial recognition system completely in the browser. Don't worry, none of your data is stored (it's in your browser's localstorage).</p>
    <p><a href="#info">How do I use this?</a></p>
  </div>
  <div class="canvas-container">
    <div class="camera">
      <video
        autoplay
        muted
        id="inputVideo"></video>
      <canvas id="overlay"></canvas>
    </div>
    <div class="detector">
      <canvas id="detectorCnv" width="50px" height="50px"></canvas>
    </div>
  </div>
  <div id="app">
    <div class="stats-container">
      <p>
        <small>
          <span>Estimated framerate:</span>
          <span>{{fps}}</span>
          <span>|</span>
        </small>
        <small>
          <span>Inference time:</span>
          <span>{{avgInferenceTime}}</span>
        </small>
      </p>
    </div>
    <div class="tabs">
      <button @click="switchTab('train')" :disabled="mode !== 'IDLE'">Training</button>
      <button @click="switchTab('detect')" :disabled="mode !== 'IDLE'">Detection</button>
      <button @click="switchTab('classlist')" :disabled="mode !== 'IDLE'">Edit/Delete classes</button>
      <button @click="switchTab('info')" :disabled="mode !== 'IDLE'">Instructions</button>
    </div>
    <training-app
      v-if="tab === 'train'"
      :draw-detection="drawDetection"
      :forward-pass="forwardPass"
      :mode="mode"
      :set-mode="setMode"
      :compute-mean-distance="computeMeanDistance"></training-app>
    <div
      class="detect-tab"
      v-if="tab === 'detect'">
      <h3>Detect faces</h3>
      <p>Current network: MTCNN</p>
      <div>
        <button :disabled="mode !== 'IDLE'"
          @click="onDetect('single')">Single shot</button>
        <button :disabled="mode !== 'IDLE'"
          @click="onDetect('realtime')">Real-time</button>
        <button @click="onDetect('stop')">Stop</button>
      </div>
    </div>
    <div
      class="classlist-tab"
      v-if="tab === 'classlist'">
      <h3>Edit/Delete classes</h3>
      <div class="face-class-container">
        <face-class
          v-for="embs in sharedState.embeddings"
          :embs="embs"
          :key="embs.className"></face-class>
      </div>
    </div>
    <div
      class="info"
      v-if="tab === 'info'">
      <h3 id="info">Instructions</h3>
      <p>First, allow the system to use your webcam. Then wait for your browser to load the weights (all in all around 8MB).</p>

      <p>This system uses your webcam to detect faces. The data is stored in your browser and is not accessible to me or other third parties. So go bonkers with this demo!</p>

      <p>Next is a brief explanation of the tabs...</p>

      <h3>Training tab</h3>

      <p>Training allows you to add your face to the system. Fill in the text input with your or your friend's name, choose how many pictures you want the system to take (1-5 is fine, it wont take pictures that are too similar) and press "Train class".</p>

      <p>Note that while the system can detect multiple faces at once, you must train for each face separately for it to run properly.</p>

      <h3>Detection tab</h3>

      <p>Detection means identifying faces and checking if they are similar to the faces stored in its memory. If an unknown face is detected, it will save that face to the database which you can rename later on.</p>

      <p>To identify between known and unknown classes, the system uses simple <a href="https://en.wikipedia.org/wiki/Euclidean_distance">Euclidean distance</a> between face embeddings.</p>

      <p>The system can detect in "Single shot" and "Real-time" modes and can detect multiple faces at once.</p>

      <ul>
        <li><strong>Single shot</strong> - the system will pause the video feed upon the first detection of a face/faces. Ideal for machines with poor hardware like phones.</li>
        <li><strong>Real-time</strong> - the system will continually detect faces and add them to memory if it doesn't know them.</li>
      </ul>

      <h3>Edit/Delete classes tab</h3>

      <p>A simple utility where one can delete stored faces or edit their names.</p>

      <h3>Next steps</h3>

      <p>This uses a pretrained <a href="https://kpzhang93.github.io/MTCNN_face_detection_alignment/index.html">MTCNN</a> for quick face detection on most hardware. In the future I'd like to provide a selection input so users can pick betwee different networks (e.g. more accurate but slower networks or vice versa).</p>

      <p>I would also love to implement a blur filter since currently the system misidentifies known classes if you move too quickly. Ignoring people with too high a blur score could increase the system's utility.</p>

      <h3>View the code</h3>

      <p>You can check out the code <a href="https://github.com/beatobongco/sentinel">here</a>. This was made with Vincent Mueller's great <a href="https://github.com/justadudewhohacks/face-api.js">face-api.js</a> library.</p>
    </div>
  </div>

  <hr>

  <p><small>Made with ðŸ”¥ by <a href="https://beatobongco.com/UI-Kata/">Beato</a> using Vincent Mueller's <a href="https://github.com/justadudewhohacks/face-api.js">face-api.js</a>.</small></p>
<script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.7.2/localforage.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.17/vue.js"></script>
<script src="js/lib/face-api.js"></script>
<script src="js/db.js"></script>
<script src="js/app.js"></script>
<!-- <script src="js/debug.js"></script> -->
</body>
</html>
